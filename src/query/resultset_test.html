<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ResultSet test</title>
    <script src="../../../closure-library/closure/goog/base.js"></script>
    <script src="../../../ydn-base/js/deps.js"></script>
    <script src="../../../ydn-db/js/deps.js"></script>
    <script type="text/javascript" src="../deps.js"></script>
    <script type="text/javascript">
        goog.require('fullproof.ResultSet');
    </script>
</head>
<body>
    <script type="text/javascript">
        goog.require('goog.testing.jsunit');
        var ft_schema = ydn.db.schema.fulltext.InvIndex.fromJson({
            name: 'test',
            lang: 'en',
            sources: [
                {
                    storeName: 'article',
                    keyPath: 'title',
                    weight: 1.0
                }, {
                    storeName: 'article',
                    keyPath: 'body',
                    weight: 0.5
                }]
        });
        var query = new ydn.db.text.QueryEntry('first', 'first', 0, 'article', 'title');

        var test_add_result = function() {
            var rs = new fullproof.ResultSet(ft_schema, [query], 10, 1);
            var results = [];
            for (var i = 0; i < 4; i++) {
              results[i] = {
                  key: 'first',
                  value: 'first',
                  position: i,
                  score: 1
              }
            }
            rs.addResult(query, results);
            assertEquals(4, rs.count());
        };
        var test_add_results = function() {
            var rs = new fullproof.ResultSet(ft_schema, [query], 10, 1);
            var results = [];
            for (var i = 0; i < 4; i++) {
                results[i] = {
                    key: 'first',
                    value: 'first',
                    position: i,
                    score: 1
                }
            }
            rs.addResult(query, results);
            results = [];
            for (var i = 0; i < 3; i++) {
                results[i] = {
                    key: 'second',
                    value: 'second',
                    position: i,
                    score: 1
                }
            }
            rs.addResult(query, results);
            assertEquals(7, rs.count());
        };

    </script>
</body>
</html>